# Коллектор для https://openweathermap.org/

Ежечасно запрашивает текущую погоду в 50 крупнейших городах мира и сохраняет в БД.  

## Стек

- Python 3.10
- Django 3.2.16
- DRF 3.14.0
- Celery 5.2.7
- Redis 4.3.4

Использован внешний API [openweathermap.org](https://openweathermap.org/) и токен автора

Структура БД построена для удобства построения сериализации данных.
Выбранные технологии позволяют:
- регулировать частоту и время загрузки данных,
- приостанавливать и возобновлять отдельные задачи,
- добавлять новые задачи,
- далее можно реализовать удобный способ добавления или удаления городов из загрузки,
- далее в проекте можно построить REST API для использования данных.

## Как запустить проект
Клонировать репозиторий:

```
git clone git@github.com:airatbakiev/weather50.git
```
Перейти в папку проекта и создать файл .env
```
cd project/project
touch ./env
```
Добавить в файл .env следующие переменные:
```
Переменная KEY: <SEСRET_KEY> django-проекта
Переменная APPID: токен сервиса openweathermap.org
Переменная TOKEN: токен сервиса Dadata.ru
Переменная: DB_ENGINE, значение: django.db.backends.postgresql
Переменная: DB_HOST, значение: db
Переменная: DB_NAME, значение: postgres
Переменная: DB_PORT, значение: 5432
Переменная: POSTGRES_USER, значение: postgres
Переменная: POSTGRES_PASSWORD, значение: postgres
```
Перейти в папку infra и запустить docker-compose.yaml
```
cd ../../infra
sudo docker-compose up
```
Миграции моделей, суперпользователь, расписание задач будут созданы автоматически.

Через несколько секунд после запуска будут загружены данные по 50 крупнейшим городам мира.

Ещё через несколько секунд начнётся первая итерация ежечасной загрузки погоды в этих городах.   

Для просмотра загруженных данных перейдите в админку проекта:

[http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)

## Ближайшие планы по развитию проекта
1. Добавить "ручки" REST API для использования данных.
2. Расширить функционал логирования,
3. Добавить уведомления в телеграм об ошибках и сбоях.




## Автор

Айрат Бакиев

## Лицензия

[MIT]((./LICENSE))